let norn = require("../norn.js")

let mut t = 0
let {actions, ...store} = norn(
    {
        list: {
            initial: []
            $add(list, item) => [...list, item]
        }
        groups: {
            initial: {}
            "list.$add"(groups, item) => {
                ...groups
                [item.id]: []
            }
            $add(groups, {id, item}) => {
                ...groups
                [id]: [
                    ...groups[id]
                    item
                ]
            }
        }
    }
    {
        "list.$add"(name) => {
            let id = t
            t += 1
            return {name, id}
        }
    }
)

store.subscribe(
    (next) => console.log(next)
)

(() => {
    await actions."list.$add"("test")
    await actions."list.$add"("test2")
    await actions."groups.$add"({id: 0, item: 100})
})()
